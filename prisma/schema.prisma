generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model employee {
  id         Int       @id @default(autoincrement())
  object_id  String    @unique
  email      String    @unique
  first_name String?
  last_name  String?
  tenant_id  String?
  created_at DateTime  @default(now())
  updated_at DateTime  @default(now())
  admin      Boolean   @default(false)

  entries    entry[]

  @@map("employee")
}

model entry {
  id          Int       @id @default(autoincrement())
  employee_id Int
  project_id  Int?
  task_id     Int?
  phase_id    Int?
  date        DateTime  @db.Date
  type        Boolean
  start_time  DateTime  @db.Time
  end_time    DateTime  @db.Time
  hours       Float     @db.Decimal(5, 2)
  notes       String?   @db.Text
  created_at  DateTime  @default(now())

  employee    employee  @relation(fields: [employee_id], references: [id], onDelete: Cascade)
  project     project?  @relation(fields: [project_id], references: [id], onDelete: SetNull)
  task        task?     @relation(fields: [task_id], references: [id])
  phase       phase?    @relation(fields: [phase_id], references: [id])

  @@map("entry")
}

model phase {
  id          Int       @id @default(autoincrement())
  name        String
  description String?   @db.Text
  project_id  Int
  created_at  DateTime  @default(now())

  project     project   @relation(fields: [project_id], references: [id], onDelete: Cascade)
  entries     entry[]

  @@map("phase")
}

model project {
  id          Int       @id @default(autoincrement())
  name        String
  description String?   @db.Text
  created_at  DateTime  @default(now())

  phases      phase[]
  entries     entry[]

  @@map("project")
}

model task {
  id          Int       @id @default(autoincrement())
  name        String
  created_at  DateTime  @default(now())

  entries     entry[]

  @@map("task")
}
